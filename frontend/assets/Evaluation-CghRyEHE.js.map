{"version":3,"file":"Evaluation-CghRyEHE.js","sources":["../../src/pages/student/Evaluation.tsx"],"sourcesContent":["import { useQuery } from '@tanstack/react-query';\nimport { sessionService } from '@/services/session.service';\nimport { useAuthStore } from '@/store/auth.store';\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { DashboardSkeleton } from \"@/components/ui/skeleton\";\nimport { Button } from \"@/components/ui/button\";\nimport { AlertCircle } from 'lucide-react';\nimport {\n  Radar,\n  RadarChart,\n  PolarGrid,\n  PolarAngleAxis,\n  PolarRadiusAxis,\n  ResponsiveContainer,\n  BarChart,\n  Bar,\n  XAxis,\n  YAxis,\n  Tooltip,\n  CartesianGrid\n} from 'recharts';\nimport { useMemo } from 'react';\n\nexport default function Evaluation() {\n  const { user } = useAuthStore();\n\n  // Fetch user's completed sessions\n  const { data: sessionsData, isLoading: sessionsLoading } = useQuery({\n    queryKey: ['user-sessions', user?.id],\n    queryFn: () => sessionService.listSessions({\n      user_id: user?.id,\n      status: 'completed',\n    }),\n    enabled: !!user?.id,\n  });\n\n  // Fetch latest session review for skill breakdown\n  const latestSessionId = sessionsData?.items?.[0]?.id;\n  const { data: reviewData, isLoading: reviewLoading, isError, error, refetch } = useQuery({\n    queryKey: ['session-review', latestSessionId],\n    queryFn: () => sessionService.getSessionReview(latestSessionId || ''),\n    enabled: !!latestSessionId,\n  });\n\n  const isLoading = sessionsLoading || reviewLoading;\n\n  // Transform skill data for radar chart\n  const radarData = useMemo(() => {\n    if (!reviewData?.skill_improvement) {\n      return [];\n    }\n\n    const skills = reviewData.skill_improvement;\n    return [\n      { subject: 'Opening', score: skills.opening || 0, fullMark: 100 },\n      { subject: 'Discovery', score: skills.discovery || 0, fullMark: 100 },\n      { subject: 'Presentation', score: skills.presentation || 0, fullMark: 100 },\n      { subject: 'Objection', score: skills.objection || 0, fullMark: 100 },\n      { subject: 'Closing', score: skills.closing || 0, fullMark: 100 },\n      { subject: 'Follow-up', score: skills.followup || 0, fullMark: 100 },\n    ];\n  }, [reviewData]);\n\n  // Transform session history for bar chart\n  const historyData = useMemo(() => {\n    if (!sessionsData?.items) return [];\n\n    return sessionsData.items\n      .slice(0, 5)\n      .reverse()\n      .map((session, index) => ({\n        name: `Session ${index + 1}`,\n        score: Math.round(Math.random() * 30 + 70), // TODO: Get actual score from session\n        date: session.created_at ? new Date(session.created_at).toLocaleDateString() : 'N/A',\n      }));\n  }, [sessionsData]);\n\n  if (isLoading) {\n    return (\n      <div className=\"space-y-6\">\n        <h1 className=\"text-3xl font-bold tracking-tight\">Evaluation & Feedback</h1>\n        <DashboardSkeleton />\n      </div>\n    );\n  }\n\n  if (isError) {\n    return (\n      <div className=\"space-y-6\">\n        <h1 className=\"text-3xl font-bold tracking-tight\">Evaluation & Feedback</h1>\n        <Card className=\"border-red-200 bg-red-50\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center gap-2 text-red-800 mb-4\">\n              <AlertCircle className=\"h-5 w-5\" />\n              <p className=\"font-medium\">Failed to load evaluation data</p>\n            </div>\n            <p className=\"text-sm text-red-700 mb-4\">\n              {error instanceof Error ? error.message : 'An error occurred while loading your evaluation'}\n            </p>\n            <Button onClick={() => refetch()} variant=\"outline\" size=\"sm\">\n              Try Again\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  if (!sessionsData?.items || sessionsData.items.length === 0) {\n    return (\n      <div className=\"space-y-6\">\n        <h1 className=\"text-3xl font-bold tracking-tight\">Evaluation & Feedback</h1>\n        <Card>\n          <CardContent className=\"pt-6\">\n            <div className=\"text-center py-12\">\n              <p className=\"text-muted-foreground mb-4\">No evaluation data available yet</p>\n              <p className=\"text-sm text-muted-foreground mb-6\">\n                Complete your first training session to see your evaluation and feedback\n              </p>\n              <Button asChild>\n                <a href=\"/student/training\">Start Training</a>\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <h1 className=\"text-3xl font-bold tracking-tight\">Evaluation & Feedback</h1>\n        <p className=\"text-sm text-muted-foreground\">\n          Based on {sessionsData.items.length} completed {sessionsData.items.length === 1 ? 'session' : 'sessions'}\n        </p>\n      </div>\n\n      <div className=\"grid gap-6 md:grid-cols-2\">\n        <Card>\n          <CardHeader>\n            <CardTitle>Skill Radar</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {radarData.length > 0 ? (\n              <div className=\"h-[300px]\">\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <RadarChart cx=\"50%\" cy=\"50%\" outerRadius=\"80%\" data={radarData}>\n                    <PolarGrid />\n                    <PolarAngleAxis dataKey=\"subject\" />\n                    <PolarRadiusAxis angle={30} domain={[0, 100]} />\n                    <Radar\n                      name=\"My Skills\"\n                      dataKey=\"score\"\n                      stroke=\"#4f46e5\"\n                      fill=\"#4f46e5\"\n                      fillOpacity={0.6}\n                    />\n                    <Tooltip />\n                  </RadarChart>\n                </ResponsiveContainer>\n              </div>\n            ) : (\n              <div className=\"h-[300px] flex items-center justify-center text-muted-foreground\">\n                No skill data available\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Performance Trend</CardTitle>\n          </CardHeader>\n          <CardContent>\n            {historyData.length > 0 ? (\n              <div className=\"h-[300px]\">\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                  <BarChart data={historyData}>\n                    <CartesianGrid strokeDasharray=\"3 3\" vertical={false} />\n                    <XAxis dataKey=\"name\" />\n                    <YAxis domain={[0, 100]} />\n                    <Tooltip />\n                    <Bar dataKey=\"score\" fill=\"#4f46e5\" radius={[4, 4, 0, 0]} />\n                  </BarChart>\n                </ResponsiveContainer>\n              </div>\n            ) : (\n              <div className=\"h-[300px] flex items-center justify-center text-muted-foreground\">\n                Complete more sessions to see your trend\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </div>\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Recent Feedback</CardTitle>\n        </CardHeader>\n        <CardContent>\n          {reviewData?.effective_adoptions && reviewData.effective_adoptions.length > 0 ? (\n            <div className=\"space-y-4\">\n              {reviewData.effective_adoptions.slice(0, 3).map((feedback, index) => (\n                <div key={index} className=\"p-4 bg-green-50 border border-green-100 rounded-lg\">\n                  <h3 className=\"font-semibold text-green-900\">Strength: {feedback.strategy || 'Good Performance'}</h3>\n                  <p className=\"text-green-800 text-sm mt-1\">\n                    {feedback.description || 'You demonstrated effective techniques in this area.'}\n                  </p>\n                </div>\n              ))}\n            </div>\n          ) : (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              No feedback available yet. Complete more training sessions to receive personalized feedback.\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n"],"names":["Evaluation","user","useAuthStore","data","sessionsData","isLoading","sessionsLoading","useQuery","queryKey","id","queryFn","sessionService","listSessions","user_id","status","enabled","latestSessionId","items","reviewData","reviewLoading","isError","error","refetch","getSessionReview","radarData","useMemo","skill_improvement","skills","subject","score","opening","fullMark","discovery","presentation","objection","closing","followup","historyData","slice","reverse","map","session","index","name","Math","round","random","date","created_at","Date","toLocaleDateString","jsxs","jsx","DashboardSkeleton","Card","CardContent","AlertCircle","Error","message","Button","length","CardHeader","CardTitle","ResponsiveContainer","RadarChart","PolarGrid","PolarAngleAxis","PolarRadiusAxis","Radar","Tooltip","BarChart","CartesianGrid","XAxis","YAxis","Bar","effective_adoptions","feedback","strategy","description"],"mappings":"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"}