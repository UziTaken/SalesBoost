{"version":3,"file":"api-BnbAaGdM.js","sources":["../../src/services/api.ts"],"sourcesContent":["/**\n * API Client\n *\n * Unified API client for all backend requests.\n */\n\nimport axios, { AxiosInstance, AxiosRequestConfig, AxiosResponse, AxiosError } from 'axios';\n\n// API configuration\nconst API_BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:8000';\nconst API_TIMEOUT = 30000; // 30 seconds\n\n// Create axios instance\nconst apiClient: AxiosInstance = axios.create({\n  baseURL: API_BASE_URL,\n  timeout: API_TIMEOUT,\n  headers: {\n    'Content-Type': 'application/json',\n  },\n});\n\n// Request interceptor\napiClient.interceptors.request.use(\n  (config) => {\n    // Add auth token if available\n    const token = localStorage.getItem('access_token');\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n\n    // Log request in development\n    if (import.meta.env.DEV) {\n      console.log(`[API Request] ${config.method?.toUpperCase()} ${config.url}`, config.data);\n    }\n\n    return config;\n  },\n  (error) => {\n    console.error('[API Request Error]', error);\n    return Promise.reject(error);\n  }\n);\n\n// Response interceptor\napiClient.interceptors.response.use(\n  (response) => {\n    // Log response in development\n    if (import.meta.env.DEV) {\n      console.log(`[API Response] ${response.config.method?.toUpperCase()} ${response.config.url}`, response.data);\n    }\n\n    return response;\n  },\n  async (error: AxiosError) => {\n    const originalRequest = error.config as AxiosRequestConfig & { _retry?: boolean };\n\n    // Handle 401 Unauthorized\n    if (error.response?.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n\n      // Clear token and redirect to login\n      localStorage.removeItem('access_token');\n      window.location.href = '/login';\n\n      return Promise.reject(error);\n    }\n\n    // Handle 429 Rate Limit\n    if (error.response?.status === 429) {\n      const retryAfter = error.response.headers['retry-after'];\n      console.warn(`[API] Rate limited. Retry after ${retryAfter}s`);\n    }\n\n    // Log error\n    console.error('[API Response Error]', {\n      status: error.response?.status,\n      message: error.message,\n      data: error.response?.data,\n    });\n\n    return Promise.reject(error);\n  }\n);\n\n// API response type\nexport interface APIResponse<T = any> {\n  data: T;\n  message?: string;\n  status: number;\n}\n\n// API error type\nexport interface APIError {\n  message: string;\n  status: number;\n  errors?: Record<string, string[]>;\n}\n\n// Generic API methods\nexport const api = {\n  get: async <T = any>(url: string, config?: AxiosRequestConfig): Promise<T> => {\n    const response = await apiClient.get<T>(url, config);\n    return response.data;\n  },\n\n  post: async <T = any>(url: string, data?: any, config?: AxiosRequestConfig): Promise<T> => {\n    const response = await apiClient.post<T>(url, data, config);\n    return response.data;\n  },\n\n  put: async <T = any>(url: string, data?: any, config?: AxiosRequestConfig): Promise<T> => {\n    const response = await apiClient.put<T>(url, data, config);\n    return response.data;\n  },\n\n  patch: async <T = any>(url: string, data?: any, config?: AxiosRequestConfig): Promise<T> => {\n    const response = await apiClient.patch<T>(url, data, config);\n    return response.data;\n  },\n\n  delete: async <T = any>(url: string, config?: AxiosRequestConfig): Promise<T> => {\n    const response = await apiClient.delete<T>(url, config);\n    return response.data;\n  },\n};\n\nexport default apiClient;\n"],"names":["API_BASE_URL","import","API_TIMEOUT","apiClient","axios","create","baseURL","timeout","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","error","console","Promise","reject","response","originalRequest","status","_retry","removeItem","window","location","href","retryAfter","warn","message","data","api","get","url","post","put","patch","delete"],"mappings":"wCASA,MAAMA,EAAeC,UACfC,EAAc,IAGdC,EAA2BC,EAAMC,OAAO,CAC5CC,QAASN,EACTO,QAASL,EACTM,QAAS,CACP,eAAgB,kBAAA,CAEpB,CAAC,EAGDL,EAAUM,aAAaC,QAAQC,IAC5BC,GAAW,CAEV,MAAMC,EAAQC,aAAaC,QAAQ,cAAc,EACjD,OAAIF,IACFD,EAAOJ,QAAQQ,cAAgB,UAAUH,CAAK,IAQzCD,CACT,EACCK,IACCC,QAAQD,MAAM,sBAAuBA,CAAK,EACnCE,QAAQC,OAAOH,CAAK,EAE/B,EAGAd,EAAUM,aAAaY,SAASV,IAC7BU,GAMQA,EAET,MAAOJ,GAAsB,aAC3B,MAAMK,EAAkBL,EAAML,OAG9B,KAAIK,EAAAA,EAAMI,WAANJ,YAAAA,EAAgBM,UAAW,KAAO,CAACD,EAAgBE,OACrDF,OAAAA,EAAgBE,OAAS,GAGzBV,aAAaW,WAAW,cAAc,EACtCC,OAAOC,SAASC,KAAO,SAEhBT,QAAQC,OAAOH,CAAK,EAI7B,KAAIA,EAAAA,EAAMI,WAANJ,YAAAA,EAAgBM,UAAW,IAAK,CAClC,MAAMM,EAAaZ,EAAMI,SAASb,QAAQ,aAAa,EACvDU,QAAQY,KAAK,mCAAmCD,CAAU,GAAG,CAC/D,CAGAX,eAAQD,MAAM,uBAAwB,CACpCM,QAAQN,EAAAA,EAAMI,WAANJ,YAAAA,EAAgBM,OACxBQ,QAASd,EAAMc,QACfC,MAAMf,EAAAA,EAAMI,WAANJ,YAAAA,EAAgBe,IAAAA,CACvB,EAEMb,QAAQC,OAAOH,CAAK,CAC7B,CACF,EAiBO,MAAMgB,EAAM,CACjBC,IAAK,MAAgBC,EAAavB,KACf,MAAMT,EAAU+B,IAAOC,EAAKvB,CAAM,GACnCoB,KAGlBI,KAAM,MAAgBD,EAAaH,EAAYpB,KAC5B,MAAMT,EAAUiC,KAAQD,EAAKH,EAAMpB,CAAM,GAC1CoB,KAGlBK,IAAK,MAAgBF,EAAaH,EAAYpB,KAC3B,MAAMT,EAAUkC,IAAOF,EAAKH,EAAMpB,CAAM,GACzCoB,KAGlBM,MAAO,MAAgBH,EAAaH,EAAYpB,KAC7B,MAAMT,EAAUmC,MAASH,EAAKH,EAAMpB,CAAM,GAC3CoB,KAGlBO,OAAQ,MAAgBJ,EAAavB,KAClB,MAAMT,EAAUoC,OAAUJ,EAAKvB,CAAM,GACtCoB,IAEpB"}