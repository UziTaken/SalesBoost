import{c as p,a as T,j as e,d as h,B as m,I as v,r as o,u as N,b as k}from"./index-Brw-vjna.js";import{S as u,A as E}from"./StatCard-Bq2Lc32v.js";import{B as b}from"./badge-sqYSPs3A.js";import{T as L,a as _,b as A,c,d as F,e as i,S as I}from"./table-CMpLMPln.js";import{P as z}from"./play-CTXE6py1.js";import{a as y}from"./api-BnbAaGdM.js";import"./card-CgWuGiW4.js";import"./index-D5GkNzM3.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],P=p("circle-check-big",M);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]],R=p("circle-play",$);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],H=p("ellipsis",q);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Q=p("layers",O);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]],V=p("scan-line",K);function G({tasks:r}){const s=T(),n=t=>{switch(t){case"in-progress":return"bg-blue-100 text-blue-700 hover:bg-blue-100/80";case"completed":return"bg-green-100 text-green-700 hover:bg-green-100/80";case"pending":return"bg-gray-100 text-gray-700 hover:bg-gray-100/80";default:return"bg-gray-100 text-gray-700"}},a=t=>{switch(t){case"in-progress":return"进行中";case"completed":return"已结束";case"pending":return"未开始";default:return t}};return e.jsx("div",{"trae-inspector-start-line":"46","trae-inspector-start-column":"4","trae-inspector-end-line":"133","trae-inspector-end-column":"10","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"bg-white rounded-lg shadow-sm overflow-hidden",children:e.jsxs(L,{children:[e.jsx(_,{className:"bg-gray-50/50",children:e.jsxs(A,{children:[e.jsx(c,{className:"w-[250px]",children:"课程名称"}),e.jsx(c,{className:"w-[200px]",children:"任务信息"}),e.jsx(c,{children:"状态"}),e.jsx(c,{className:"w-[200px]",children:"时间范围"}),e.jsx(c,{className:"w-[200px]",children:"进度"}),e.jsx(c,{className:"text-right",children:"操作"})]})}),e.jsx(F,{children:r.map(t=>e.jsxs(A,{className:"hover:bg-muted/50",children:[e.jsx(i,{className:"font-medium",children:e.jsxs("div",{"trae-inspector-start-line":"62","trae-inspector-start-column":"16","trae-inspector-end-line":"67","trae-inspector-end-column":"22","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"flex flex-col gap-1",children:[e.jsx("span",{"trae-inspector-start-line":"63","trae-inspector-start-column":"18","trae-inspector-end-line":"63","trae-inspector-end-column":"98","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"text-base font-semibold text-gray-900",children:t.courseName}),t.courseSubtitle&&e.jsx("span",{"trae-inspector-start-line":"65","trae-inspector-start-column":"20","trae-inspector-end-line":"65","trae-inspector-end-column":"88","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"text-xs text-gray-500",children:t.courseSubtitle})]})}),e.jsx(i,{children:e.jsxs("div",{"trae-inspector-start-line":"70","trae-inspector-start-column":"16","trae-inspector-end-line":"80","trae-inspector-end-column":"22","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"flex flex-col gap-1",children:[e.jsx("span",{"trae-inspector-start-line":"71","trae-inspector-start-column":"18","trae-inspector-end-line":"71","trae-inspector-end-column":"80","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"text-sm text-gray-700",children:t.taskInfo}),e.jsx("div",{"trae-inspector-start-line":"72","trae-inspector-start-column":"18","trae-inspector-end-line":"79","trae-inspector-end-column":"24","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"flex",children:e.jsx(b,{variant:"secondary",className:h("text-xs font-normal",t.taskTag==="新人培训"||t.taskTag==="必修"?"bg-purple-100 text-purple-700":t.taskTag==="已上线"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"),children:t.taskTag})})]})}),e.jsx(i,{children:e.jsx(b,{className:h("rounded-full font-normal shadow-none",n(t.status)),children:a(t.status)})}),e.jsx(i,{children:e.jsxs("div",{"trae-inspector-start-line":"88","trae-inspector-start-column":"16","trae-inspector-end-line":"91","trae-inspector-end-column":"22","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"text-sm text-gray-500 flex flex-col",children:[e.jsx("span",{"trae-inspector-start-line":"89","trae-inspector-start-column":"18","trae-inspector-end-line":"89","trae-inspector-end-column":"53","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",children:t.timeRange.start}),e.jsxs("span",{"trae-inspector-start-line":"90","trae-inspector-start-column":"18","trae-inspector-end-line":"90","trae-inspector-end-column":"73","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"text-xs",children:["至 ",t.timeRange.end]})]})}),e.jsx(i,{children:e.jsxs("div",{"trae-inspector-start-line":"94","trae-inspector-start-column":"16","trae-inspector-end-line":"110","trae-inspector-end-column":"22","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"space-y-1.5 w-full max-w-[140px]",children:[e.jsxs("div",{"trae-inspector-start-line":"95","trae-inspector-start-column":"18","trae-inspector-end-line":"98","trae-inspector-end-column":"24","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"flex justify-between text-xs",children:[e.jsx("span",{"trae-inspector-start-line":"96","trae-inspector-start-column":"20","trae-inspector-end-line":"96","trae-inspector-end-column":"62","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22%E5%AE%8C%E6%88%90%E5%BA%A6%22%2C%22textStartLine%22%3A%2296%22%2C%22textStartColumn%22%3A%2252%22%2C%22textEndLine%22%3A%2296%22%2C%22textEndColumn%22%3A%2255%22%2C%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"text-gray-500",children:"完成度"}),e.jsxs("span",{"trae-inspector-start-line":"97","trae-inspector-start-column":"20","trae-inspector-end-line":"97","trae-inspector-end-column":"120","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"text-purple-600 font-medium",children:[t.progress.completed,"/",t.progress.total]})]}),e.jsx("div",{"trae-inspector-start-line":"99","trae-inspector-start-column":"18","trae-inspector-end-line":"104","trae-inspector-end-column":"24","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"h-1.5 w-full bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{"trae-inspector-start-line":"100","trae-inspector-start-column":"20","trae-inspector-end-line":"103","trae-inspector-end-column":"22","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"h-full bg-primary rounded-full transition-all duration-300",style:{width:`${t.progress.completed/t.progress.total*100}%`}})}),t.progress.bestScore&&e.jsxs("div",{"trae-inspector-start-line":"106","trae-inspector-start-column":"20","trae-inspector-end-line":"108","trae-inspector-end-column":"26","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"text-xs text-gray-400",children:["最佳得分: ",e.jsxs("span",{"trae-inspector-start-line":"107","trae-inspector-start-column":"28","trae-inspector-end-line":"107","trae-inspector-end-column":"95","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"text-purple-600",children:[t.progress.bestScore,"分"]})]})]})}),e.jsx(i,{className:"text-right",children:e.jsxs("div",{"trae-inspector-start-line":"113","trae-inspector-start-column":"16","trae-inspector-end-line":"127","trae-inspector-end-column":"22","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\TaskTable.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"flex items-center justify-end gap-3",children:[e.jsxs(m,{size:"sm",className:"bg-purple-600 hover:bg-purple-700 text-white gap-1 rounded-full px-4 shadow-sm shadow-purple-200",onClick:()=>s(`/student/training/${t.id}`),children:[e.jsx(z,{className:"w-3 h-3 fill-current"})," 去练习"]}),e.jsx(m,{variant:"outline",size:"icon",className:"h-8 w-8 text-gray-400 hover:text-gray-600 rounded-lg border-gray-200",children:e.jsx(V,{className:"w-4 h-4"})}),e.jsx(m,{variant:"ghost",size:"icon",className:"h-8 w-8 text-gray-400 hover:text-gray-600 rounded-lg",children:e.jsx(H,{className:"w-4 h-4"})})]})})]},t.id))})]})})}const J=[{id:"all",label:"全部"},{id:"pending",label:"未开始"},{id:"in-progress",label:"进行中"},{id:"completed",label:"已结束"}];function U({currentFilter:r,onFilterChange:s,onSearch:n}){return e.jsxs("div",{"trae-inspector-start-line":"21","trae-inspector-start-column":"4","trae-inspector-end-line":"48","trae-inspector-end-column":"10","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\FilterBar.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"flex flex-col sm:flex-row items-center justify-between gap-4 py-4",children:[e.jsxs("div",{"trae-inspector-start-line":"22","trae-inspector-start-column":"6","trae-inspector-end-line":"29","trae-inspector-end-column":"12","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\FilterBar.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"relative w-full sm:w-[300px]",children:[e.jsx(I,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(v,{placeholder:"搜索课程名称、任务名称...",className:"pl-9 bg-gray-50 border-gray-200 rounded-full focus-visible:ring-primary",onChange:a=>n(a.target.value)})]}),e.jsx("div",{"trae-inspector-start-line":"30","trae-inspector-start-column":"6","trae-inspector-end-line":"47","trae-inspector-end-column":"12","trae-inspector-file-path":"src\\\\components\\\\dashboard\\\\FilterBar.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"flex items-center gap-2 w-full sm:w-auto overflow-x-auto pb-2 sm:pb-0",children:J.map(a=>e.jsx(m,{variant:r===a.id?"default":"outline",size:"sm",onClick:()=>s(a.id),className:h("rounded-full px-6 min-w-fit",r===a.id?"bg-primary text-white hover:bg-primary/90 shadow-sm border-transparent":"bg-white text-gray-500 border-gray-200 hover:bg-gray-50 hover:text-gray-900"),children:a.label},a.id))})]})}const W="/api/v1/tasks",X="/api/v1/statistics",Y=async()=>{try{return(await y.get(W)).items.map(s=>({id:s.id.toString(),courseName:s.title,courseSubtitle:s.description||"",taskInfo:s.instructions||"",taskTag:s.task_type,status:ee(s.status),timeRange:{start:s.created_at,end:s.updated_at},progress:{completed:Math.floor((s.completion_rate||0)/100*(s.points||100)),total:s.points||100,bestScore:s.average_score||0}}))}catch(r){return console.error("[TaskService] Failed to fetch tasks:",r),[]}},Z=async()=>{try{return await y.get(X)}catch(r){return console.error("[TaskService] Failed to fetch statistics:",r),{totalTasks:0,inProgress:0,completed:0,averageScore:0,lockedItems:0}}};function ee(r){switch(r.toLowerCase()){case"locked":return"pending";case"available":return"pending";case"in_progress":case"active":return"in-progress";case"completed":return"completed";default:return"pending"}}function le(){const[r,s]=o.useState([]),[n,a]=o.useState(null),[t,w]=o.useState("all"),[C,B]=o.useState(""),[D,g]=o.useState(!0),{user:S}=N(),{toast:f}=k();o.useEffect(()=>{(async()=>{g(!0);try{const[l,x]=await Promise.all([Y(),Z()]);s(l),a(x)}catch(l){console.error("Failed to fetch dashboard data",l),f({variant:"destructive",title:"加载失败",description:"无法连接到后端服务器。请确保后端正在运行 (python main.py)。"})}finally{g(!1)}})()},[S,f]);const j=r.filter(d=>{const l=t==="all"||d.status===t,x=d.courseName.toLowerCase().includes(C.toLowerCase())||d.taskInfo.toLowerCase().includes(C.toLowerCase());return l&&x});return D?e.jsx("div",{"trae-inspector-start-line":"56","trae-inspector-start-column":"11","trae-inspector-end-line":"56","trae-inspector-end-column":"74","trae-inspector-file-path":"src\\\\pages\\\\student\\\\Dashboard.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22Loading...%22%2C%22textStartLine%22%3A%2256%22%2C%22textStartColumn%22%3A%2258%22%2C%22textEndLine%22%3A%2256%22%2C%22textEndColumn%22%3A%2268%22%2C%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"p-8 text-center text-gray-500",children:"Loading..."}):e.jsxs("div",{"trae-inspector-start-line":"60","trae-inspector-start-column":"4","trae-inspector-end-line":"114","trae-inspector-end-column":"10","trae-inspector-file-path":"src\\\\pages\\\\student\\\\Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"space-y-6",children:[e.jsxs("div",{"trae-inspector-start-line":"62","trae-inspector-start-column":"6","trae-inspector-end-line":"65","trae-inspector-end-column":"12","trae-inspector-file-path":"src\\\\pages\\\\student\\\\Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",children:[e.jsx("h1",{"trae-inspector-start-line":"63","trae-inspector-start-column":"8","trae-inspector-end-line":"63","trae-inspector-end-column":"66","trae-inspector-file-path":"src\\\\pages\\\\student\\\\Dashboard.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22%E4%BB%BB%E5%8A%A1%E7%AE%A1%E7%90%86%22%2C%22textStartLine%22%3A%2263%22%2C%22textStartColumn%22%3A%2257%22%2C%22textEndLine%22%3A%2263%22%2C%22textEndColumn%22%3A%2261%22%2C%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"text-2xl font-bold text-gray-900",children:"任务管理"}),e.jsx("p",{"trae-inspector-start-line":"64","trae-inspector-start-column":"8","trae-inspector-end-line":"64","trae-inspector-end-column":"62","trae-inspector-file-path":"src\\\\pages\\\\student\\\\Dashboard.tsx","trae-inspector-static-props":"%7B%22text%22%3A%22%E6%9F%A5%E7%9C%8B%E6%89%80%E6%9C%89%E5%AD%A6%E4%B9%A0%E4%BB%BB%E5%8A%A1%22%2C%22textStartLine%22%3A%2264%22%2C%22textStartColumn%22%3A%2250%22%2C%22textEndLine%22%3A%2264%22%2C%22textEndColumn%22%3A%2258%22%2C%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"text-gray-500 text-sm mt-1",children:"查看所有学习任务"})]}),n&&e.jsxs("div",{"trae-inspector-start-line":"69","trae-inspector-start-column":"8","trae-inspector-end-line":"102","trae-inspector-end-column":"14","trae-inspector-file-path":"src\\\\pages\\\\student\\\\Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx(u,{title:"全部任务",value:n.totalTasks,subtitle:"任务总数",icon:Q,iconColor:"text-purple-600",iconBgColor:"bg-purple-100"}),e.jsx(u,{title:"进行中",value:n.inProgress,subtitle:"课程进行中",icon:R,iconColor:"text-blue-500",iconBgColor:"bg-blue-100"}),e.jsx(u,{title:"已完成",value:n.completed,subtitle:"课程完成",icon:P,iconColor:"text-green-500",iconBgColor:"bg-green-100"}),e.jsx(u,{title:"平均分数",value:n.averageScore,subtitle:"最近成绩",icon:E,iconColor:"text-yellow-500",iconBgColor:"bg-yellow-100"})]}),e.jsxs("div",{"trae-inspector-start-line":"106","trae-inspector-start-column":"6","trae-inspector-end-line":"113","trae-inspector-end-column":"12","trae-inspector-file-path":"src\\\\pages\\\\student\\\\Dashboard.tsx","trae-inspector-static-props":"%7B%22cwd%22%3A%22D%3A%5C%5CSalesBoost%5C%5Cfrontend%22%7D",className:"space-y-4",children:[e.jsx(U,{currentFilter:t,onFilterChange:w,onSearch:B}),e.jsx(G,{tasks:j})]})]})}export{le as default};
