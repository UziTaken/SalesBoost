# SalesBoost 腾讯云自动化部署清单

**目标：** 一键自动化部署到腾讯云生产环境

---

## 📋 需要提供的信息

### 1. 腾讯云服务器信息

#### 云服务器（CVM）
```yaml
# 请提供以下信息：
服务器IP: _________________
SSH端口: 22 (默认)
SSH用户名: root (默认) 或 ubuntu
SSH密钥路径: ~/.ssh/id_rsa (或提供密钥内容)
服务器区域: ap-guangzhou / ap-shanghai / ap-beijing
服务器规格: 2核4G / 4核8G / 8核16G (建议至少4核8G)
操作系统: Ubuntu 22.04 LTS (推荐)
```

**如何获取：**
1. 登录腾讯云控制台
2. 进入"云服务器 CVM"
3. 查看实例列表，复制公网IP
4. 下载SSH密钥（如果使用密钥登录）

---

### 2. 数据库信息

#### 云数据库 PostgreSQL
```yaml
# 选项A：使用腾讯云数据库（推荐）
数据库地址: _________________
数据库端口: 5432
数据库名称: salesboost
数据库用户: _________________
数据库密码: _________________

# 选项B：自建数据库（在CVM上）
是否自建: 是 / 否
```

**如何获取（腾讯云数据库）：**
1. 进入"云数据库 PostgreSQL"
2. 创建实例（推荐：2核4G，100GB存储）
3. 复制内网地址、端口、用户名、密码

---

### 3. 对象存储（COS）

```yaml
# 用于存储录音文件、导出文件等
存储桶名称: _________________
存储桶区域: ap-guangzhou / ap-shanghai
SecretId: _________________
SecretKey: _________________
CDN域名: _________________ (可选)
```

**如何获取：**
1. 进入"对象存储 COS"
2. 创建存储桶（推荐：标准存储，私有读写）
3. 进入"密钥管理" → "API密钥管理"
4. 创建密钥，复制SecretId和SecretKey

---

### 4. 域名和SSL证书

```yaml
# 前端域名
前端域名: www.yourdomain.com
是否已备案: 是 / 否

# 后端API域名
API域名: api.yourdomain.com
是否已备案: 是 / 否

# SSL证书
证书类型: 腾讯云免费证书 / 自有证书
证书路径: _________________ (如果是自有证书)
```

**如何配置：**
1. 进入"域名注册" → 购买域名
2. 进入"SSL证书" → 申请免费证书
3. 进入"云解析DNS" → 添加域名解析记录

---

### 5. API密钥配置

#### LLM API密钥（至少提供一个）
```yaml
# OpenAI
OPENAI_API_KEY: sk-... (可选)

# Anthropic (Claude)
ANTHROPIC_API_KEY: sk-ant-... (推荐)

# Google Gemini
GEMINI_API_KEY: ... (可选)
```

#### Supabase配置
```yaml
SUPABASE_URL: https://xxx.supabase.co
SUPABASE_KEY: eyJhbGc...
SUPABASE_JWT_SECRET: your-jwt-secret
```

**如何获取：**
- OpenAI: https://platform.openai.com/api-keys
- Anthropic: https://console.anthropic.com/
- Gemini: https://makersuite.google.com/app/apikey
- Supabase: https://app.supabase.com/ → 项目设置

---

### 6. Redis缓存（可选但推荐）

```yaml
# 选项A：使用腾讯云Redis（推荐）
Redis地址: _________________
Redis端口: 6379
Redis密码: _________________

# 选项B：自建Redis（在CVM上）
是否自建: 是 / 否
```

---

### 7. 监控和日志

```yaml
# 是否启用腾讯云监控
启用云监控: 是 / 否

# 是否启用日志服务（CLS）
启用日志服务: 是 / 否

# 告警通知
告警邮箱: _________________
告警手机: _________________
```

---

## 🚀 部署方式选择

请选择一种部署方式：

### 方式1：Docker Compose（推荐，简单快速）
```
✅ 优点：
- 一键部署，5分钟上线
- 易于管理和更新
- 资源占用适中

❌ 缺点：
- 单机部署，不支持自动扩容
- 适合中小规模（<1000并发）

推荐配置：4核8G服务器
```

### 方式2：Kubernetes（企业级，高可用）
```
✅ 优点：
- 自动扩缩容
- 高可用性
- 适合大规模（>1000并发）

❌ 缺点：
- 配置复杂
- 需要多台服务器
- 成本较高

推荐配置：3台4核8G服务器（1主2从）
```

### 方式3：Serverless（按量付费）
```
✅ 优点：
- 按需付费，成本低
- 自动扩容
- 无需管理服务器

❌ 缺点：
- 冷启动延迟
- 功能限制
- 调试困难

推荐场景：初期测试、流量不稳定
```

**您的选择：** _________________ (Docker / Kubernetes / Serverless)

---

## 📝 配置文件模板

### .env.production（生产环境变量）
```bash
# ============================================
# 环境配置
# ============================================
ENV_STATE=production
DEBUG=false
LOG_LEVEL=INFO

# ============================================
# 数据库配置
# ============================================
DATABASE_URL=postgresql://user:password@host:5432/salesboost

# ============================================
# Redis配置
# ============================================
REDIS_URL=redis://:password@host:6379/0

# ============================================
# LLM API密钥
# ============================================
OPENAI_API_KEY=sk-...
ANTHROPIC_API_KEY=sk-ant-...
GEMINI_API_KEY=...

# ============================================
# Supabase配置
# ============================================
SUPABASE_URL=https://xxx.supabase.co
SUPABASE_KEY=eyJhbGc...
SUPABASE_JWT_SECRET=your-jwt-secret

# ============================================
# 腾讯云COS配置
# ============================================
TENCENT_SECRET_ID=...
TENCENT_SECRET_KEY=...
COS_BUCKET=salesboost-1234567890
COS_REGION=ap-guangzhou

# ============================================
# 应用配置
# ============================================
FRONTEND_URL=https://www.yourdomain.com
API_URL=https://api.yourdomain.com
CORS_ORIGINS=https://www.yourdomain.com

# ============================================
# 功能开关
# ============================================
ENABLE_CONSTITUTIONAL_AI=true
ENABLE_MOE_ROUTER=true
ENABLE_RL_LEARNING=true

# ============================================
# 模型配置
# ============================================
DEFAULT_LLM_PROVIDER=anthropic
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022
OPENAI_MODEL=gpt-4-turbo-preview
GEMINI_MODEL=gemini-1.5-pro
```

---

## 🔐 安全检查清单

在部署前，请确认：

- [ ] 所有密码都是强密码（至少16位，包含大小写字母、数字、特殊字符）
- [ ] SSH密钥已妥善保管，不要泄露
- [ ] API密钥已妥善保管，不要提交到Git
- [ ] 数据库只允许内网访问
- [ ] 服务器防火墙已配置（只开放80、443、22端口）
- [ ] SSL证书已配置
- [ ] 域名已备案（中国大陆必需）

---

## 📦 部署流程预览

完成上述信息收集后，我将为您执行以下自动化部署：

### 第1步：环境准备（5分钟）
```bash
✓ 连接到腾讯云服务器
✓ 安装Docker和Docker Compose
✓ 配置防火墙规则
✓ 安装Nginx反向代理
```

### 第2步：代码部署（3分钟）
```bash
✓ 克隆代码仓库
✓ 配置环境变量
✓ 构建Docker镜像
✓ 启动服务容器
```

### 第3步：数据库初始化（2分钟）
```bash
✓ 创建数据库表
✓ 导入初始数据
✓ 配置数据库备份
```

### 第4步：域名和SSL配置（5分钟）
```bash
✓ 配置Nginx虚拟主机
✓ 申请/安装SSL证书
✓ 配置域名解析
✓ 启用HTTPS
```

### 第5步：监控和日志（3分钟）
```bash
✓ 配置健康检查
✓ 启用日志收集
✓ 配置告警规则
```

### 第6步：验证和测试（2分钟）
```bash
✓ 测试前端访问
✓ 测试API接口
✓ 测试数据库连接
✓ 测试文件上传
```

**总计：约20分钟完成部署** ⚡

---

## 💰 成本估算

### 基础配置（适合初期，支持100-500并发用户）
```
云服务器CVM (4核8G): ¥200/月
云数据库PostgreSQL (2核4G): ¥150/月
Redis缓存 (1G): ¥50/月
对象存储COS: ¥10/月 (100GB)
CDN流量: ¥50/月 (100GB)
域名: ¥60/年
SSL证书: 免费

总计: ¥460/月 + ¥60/年
```

### 标准配置（适合成长期，支持500-2000并发用户）
```
云服务器CVM (8核16G): ¥400/月
云数据库PostgreSQL (4核8G): ¥300/月
Redis缓存 (2G): ¥100/月
对象存储COS: ¥30/月 (500GB)
CDN流量: ¥150/月 (500GB)
负载均衡CLB: ¥50/月

总计: ¥1030/月
```

### 企业配置（适合规模化，支持2000+并发用户）
```
云服务器CVM x3 (8核16G): ¥1200/月
云数据库PostgreSQL (8核16G): ¥600/月
Redis缓存 (4G): ¥200/月
对象存储COS: ¥100/月 (2TB)
CDN流量: ¥500/月 (2TB)
负载均衡CLB: ¥100/月
容器服务TKE: ¥300/月

总计: ¥3000/月
```

---

## 📞 下一步

请按照以下格式提供信息：

```yaml
# ============================================
# 腾讯云服务器信息
# ============================================
服务器IP:
SSH端口: 22
SSH用户名: root
SSH密钥: [请提供密钥内容或路径]

# ============================================
# 数据库信息
# ============================================
数据库类型: 腾讯云PostgreSQL / 自建
数据库地址:
数据库端口: 5432
数据库名称: salesboost
数据库用户:
数据库密码:

# ============================================
# 域名信息
# ============================================
前端域名:
API域名:
是否已备案: 是/否

# ============================================
# API密钥
# ============================================
ANTHROPIC_API_KEY:
OPENAI_API_KEY: (可选)
SUPABASE_URL:
SUPABASE_KEY:
SUPABASE_JWT_SECRET:

# ============================================
# 腾讯云COS
# ============================================
TENCENT_SECRET_ID:
TENCENT_SECRET_KEY:
COS_BUCKET:
COS_REGION:

# ============================================
# 部署方式
# ============================================
部署方式: Docker / Kubernetes / Serverless
```

**提供完这些信息后，我将立即为您生成完整的自动化部署脚本！** 🚀

---

## ⚠️ 重要提示

1. **敏感信息保护：** 请通过私密方式提供密钥和密码，不要在公开渠道分享
2. **备案要求：** 如果使用中国大陆服务器，域名必须备案才能访问
3. **成本控制：** 建议先使用基础配置测试，确认无误后再升级
4. **数据备份：** 部署完成后，我会配置自动备份策略

准备好了吗？提供信息后，我们开始自动化部署！✨
